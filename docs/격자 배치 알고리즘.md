

* * *

2\. 글자 격자 배치 알고리즘 ⚙️
--------------------

글자 배치 알고리즘은 **공정성**과 **재미**를 동시에 만족시켜야 합니다. 단순히 무작위로 배치해서는 안 됩니다.

### A. 목표 정의

1.  **밀도 유지:** 정답 단어에 포함된 글자의 비율을 높게 유지하여 단어를 찾을 기회를 늘립니다.
    
2.  **난이도 조절:** 훼방 글자(Dummy Letters)를 추가하여 난이도를 조절합니다.
    
3.  **무작위성:** 매 게임마다 다른 배열을 제공합니다.
    

### B. 알고리즘 상세 설계

#### **Step 1: 정답 글자 수집**

*   **입력:** 현재 카테고리에 해당하는 모든 정답 단어 목록 (예: `['호랑이', '사자', '곰', '닭']`).
    
*   **처리:** 이 단어들을 모두 한 글자씩 분해하여 `List<String>`에 모읍니다. (예: `['호', '랑', '이', '사', '자', '곰', '닭']`)
    
*   **중복 제거:** 정답에 사용된 **모든 고유한 글자** 목록을 만듭니다. (예: `{'호', '랑', '이', '사', '자', '곰', '닭'}`)
    

#### **Step 2: 훼방 글자 (Dummy Letters) 생성**

*   **목표:** 전체 격자 크기(예: 8×8\=64 칸)를 채울 글자 목록을 만듭니다.
    
*   **비율 결정:** 예를 들어, \*\*정답 글자 : 훼방 글자 = 70% : 30%\*\*로 설정합니다.
    
*   **훼방 생성:** 정답 목록에 없는, 하지만 흔히 사용되는 모음/자음(예: '아', '다', '를', '의')을 무작위로 추출하여 훼방 글자 목록을 만듭니다.
    

#### **Step 3: 최종 격자 배열**

1.  **목록 합치기:** 정답 글자와 훼방 글자를 합쳐 **최종 글자 목록**을 만듭니다.
    
2.  **무작위 셔플:** `dart:math`의 `Random` 클래스를 사용하여 최종 목록을 **`shuffle()`** 메서드로 완벽하게 섞습니다.
    
3.  **격자 할당:** 섞인 목록을 8×8 격자(2차원 배열 또는 1차원 리스트)에 순서대로 할당합니다.
    

### C. Flutter 구현 조언 (PlayArea)

`PlayArea` 위젯에서 \*\*`GestureDetector`\*\*의 `onPanUpdate`를 사용하여 터치 이동 시 **가장 가까운 글자 블록**의 중심 좌표를 계산해야 합니다.

*   **좌표 변환:** `onPanUpdate`에서 제공하는 전역 좌표를 `GridView.builder`의 각 항목이 차지하는 **로컬 좌표**로 변환하고, 그 로컬 좌표가 어떤 글자 블록의 경계 안에 있는지 판단해야 합니다.
    
*   **연결 순서:** 연결된 블록의 `index`를 \*\*`Set`\*\*에 저장하여 중복을 방지하고, \*\*`List`\*\*에 저장하여 단어의 순서를 유지해야 합니다. 손가락이 떼지면 (`onPanEnd`), 이 `List`를 조합하여 단어를 검증합니다.
    

이 디자인과 알고리즘을 기반으로 GameScreen 개발을 시작하면 됩니다. 다음 단계로 \*\*상태 관리(Provider)\*\*를 사용하여 이 모든 로직을 UI와 분리하는 작업을 권장합니다.